\hypertarget{classQbeTray_1_1Tray}{
\section{Tray Klassenreferenz}
\label{classQbeTray_1_1Tray}\index{QbeTray::Tray@{QbeTray::Tray}}
}
\subsection*{\"{O}ffentliche Methoden}
\begin{CompactItemize}
\item 
\hyperlink{classQbeTray_1_1Tray_QbeTray_1_1Traya0}{Tray} ()
\end{CompactItemize}
\subsection*{Private Methoden}
\begin{CompactItemize}
\item 
void \hyperlink{classQbeTray_1_1Tray_QbeTray_1_1Trayd0}{timer\_\-Tick} (object sender, Event\-Args e)
\item 
void \hyperlink{classQbeTray_1_1Tray_QbeTray_1_1Trayd1}{System\-Events\_\-Session\-Ending} (object sender, Microsoft.Win32.Session\-Ending\-Event\-Args e)
\item 
void \hyperlink{classQbeTray_1_1Tray_QbeTray_1_1Trayd2}{System\-Events\_\-Power\-Mode\-Changed} (object sender, Microsoft.Win32.Power\-Mode\-Changed\-Event\-Args e)
\end{CompactItemize}
\subsection*{Private Attribute}
\begin{CompactItemize}
\item 
\hyperlink{classQbeTray_1_1TrayNotify}{Tray\-Notify} \hyperlink{classQbeTray_1_1Tray_QbeTray_1_1Trayr0}{notify\-Icon}
\item 
System.Windows.Forms.Timer \hyperlink{classQbeTray_1_1Tray_QbeTray_1_1Trayr1}{timer}
\item 
System.Resources.Resource\-Manager \hyperlink{classQbeTray_1_1Tray_QbeTray_1_1Trayr2}{resources}
\item 
int \hyperlink{classQbeTray_1_1Tray_QbeTray_1_1Trayr3}{prev\-Connstate} = 0
\item 
int \hyperlink{classQbeTray_1_1Tray_QbeTray_1_1Trayr4}{prev\-Inetstate} = 1
\end{CompactItemize}


\subsection{Beschreibung der Konstruktoren und Destruktoren}
\hypertarget{classQbeTray_1_1Tray_QbeTray_1_1Traya0}{
\index{QbeTray::Tray@{Qbe\-Tray::Tray}!Tray@{Tray}}
\index{Tray@{Tray}!QbeTray::Tray@{Qbe\-Tray::Tray}}
\subsubsection[Tray]{\setlength{\rightskip}{0pt plus 5cm}\hyperlink{classQbeTray_1_1Tray}{Tray} ()}}
\label{classQbeTray_1_1Tray_QbeTray_1_1Traya0}




Definiert in Zeile 18 der Datei Tray.cs.

Benutzt Tray::notify\-Icon, Tray::resources, Tray\-Notify::Set\-Tray\-Icon(), Tray::System\-Events\_\-Power\-Mode\-Changed(), Tray::System\-Events\_\-Session\-Ending(), Tray::timer und Tray::timer\_\-Tick().



\footnotesize\begin{verbatim}19     {
20       resources = new System.Resources.ResourceManager("Resource",System.Reflection.Assembly.GetExecutingAssembly());
21       notifyIcon = new TrayNotify(); //System.Windows.Forms.NotifyIcon();
22       notifyIcon.Text = "Qbe Tray";
23       notifyIcon.Icon = (System.Drawing.Icon)resources.GetObject("IconNoConnection");
24       /*      notifyIcon.Visible = true;
25             notifyIcon.MouseDown += new System.Windows.Forms.MouseEventHandler(notifyIcon_MouseDown);
26       */  
27       notifyIcon.SetTrayIcon();
28 
29       timer = new System.Windows.Forms.Timer();
30       timer.Interval = 30000;
31       timer.Tick += new EventHandler(timer_Tick);
32       timer.Enabled = true;
33 
34       Microsoft.Win32.SystemEvents.SessionEnding += new Microsoft.Win32.SessionEndingEventHandler(SystemEvents_SessionEnding);
35       Microsoft.Win32.SystemEvents.PowerModeChanged += new Microsoft.Win32.PowerModeChangedEventHandler(SystemEvents_PowerModeChanged);
36     }
\end{verbatim}\normalsize 


\subsection{Dokumentation der Elementfunktionen}
\hypertarget{classQbeTray_1_1Tray_QbeTray_1_1Trayd2}{
\index{QbeTray::Tray@{Qbe\-Tray::Tray}!SystemEvents_PowerModeChanged@{SystemEvents\_\-PowerModeChanged}}
\index{SystemEvents_PowerModeChanged@{SystemEvents\_\-PowerModeChanged}!QbeTray::Tray@{Qbe\-Tray::Tray}}
\subsubsection[SystemEvents\_\-PowerModeChanged]{\setlength{\rightskip}{0pt plus 5cm}void System\-Events\_\-Power\-Mode\-Changed (object {\em sender}, Microsoft.Win32.Power\-Mode\-Changed\-Event\-Args {\em e})\hspace{0.3cm}{\tt  \mbox{[}private\mbox{]}}}}
\label{classQbeTray_1_1Tray_QbeTray_1_1Trayd2}




Definiert in Zeile 95 der Datei Tray.cs.

Wird benutzt von Tray::Tray().



\footnotesize\begin{verbatim}96     {
97       if (e.Mode == Microsoft.Win32.PowerModes.Resume) 
98       { 
99         QbeSAS.SysState.runLogin();
100       }
101       else if (e.Mode == Microsoft.Win32.PowerModes.Suspend)
102       {
103         QbeSAS.SysState.runLogout();
104       }
105     }
\end{verbatim}\normalsize 
\hypertarget{classQbeTray_1_1Tray_QbeTray_1_1Trayd1}{
\index{QbeTray::Tray@{Qbe\-Tray::Tray}!SystemEvents_SessionEnding@{SystemEvents\_\-SessionEnding}}
\index{SystemEvents_SessionEnding@{SystemEvents\_\-SessionEnding}!QbeTray::Tray@{Qbe\-Tray::Tray}}
\subsubsection[SystemEvents\_\-SessionEnding]{\setlength{\rightskip}{0pt plus 5cm}void System\-Events\_\-Session\-Ending (object {\em sender}, Microsoft.Win32.Session\-Ending\-Event\-Args {\em e})\hspace{0.3cm}{\tt  \mbox{[}private\mbox{]}}}}
\label{classQbeTray_1_1Tray_QbeTray_1_1Trayd1}




Definiert in Zeile 90 der Datei Tray.cs.

Wird benutzt von Tray::Tray().



\footnotesize\begin{verbatim}91     {
92       QbeSAS.SysState.runLogout();
93     }
\end{verbatim}\normalsize 
\hypertarget{classQbeTray_1_1Tray_QbeTray_1_1Trayd0}{
\index{QbeTray::Tray@{Qbe\-Tray::Tray}!timer_Tick@{timer\_\-Tick}}
\index{timer_Tick@{timer\_\-Tick}!QbeTray::Tray@{Qbe\-Tray::Tray}}
\subsubsection[timer\_\-Tick]{\setlength{\rightskip}{0pt plus 5cm}void timer\_\-Tick (object {\em sender}, Event\-Args {\em e})\hspace{0.3cm}{\tt  \mbox{[}private\mbox{]}}}}
\label{classQbeTray_1_1Tray_QbeTray_1_1Trayd0}




Definiert in Zeile 39 der Datei Tray.cs.

Benutzt Tray::notify\-Icon, Tray::prev\-Connstate, Tray::prev\-Inetstate, Tray::resources, Tray\-Notify::Show\-Tray\-Balloon() und Tray\-Notify::Update\-Tray\-Icon().

Wird benutzt von Tray::Tray().



\footnotesize\begin{verbatim}40     {
41       int inetState = QbeSAS.SysState.queryServiceAgentInt("internetstate");
42       int connState = QbeSAS.SysState.queryServiceAgentInt("connectionstate");
43       notifyIcon.Text = QbeSAS.SysState.getStateString(connState,inetState,QbeSAS.SysState.queryServiceAgentStr("username"));
44       switch (connState)
45       {
46         case 0:
47         {
48           if (inetState == 0)
49             notifyIcon.Icon = (System.Drawing.Icon)resources.GetObject("IconInetFree");
50           if (inetState == 1)
51             notifyIcon.Icon = (System.Drawing.Icon)resources.GetObject("IconInetLock");
52           break;
53         }
54         case 1:
55         {
56           notifyIcon.Icon = (System.Drawing.Icon)resources.GetObject("IconNoConnection");
57           break;
58         }
59         case -1:
60         default:
61         {
62           notifyIcon.Icon = (System.Drawing.Icon)resources.GetObject("IconNoConnection");
63           break;
64         }
65       }
66       notifyIcon.UpdateTrayIcon();
67       
68 /*      if ( (prevConnstate != connState) && (connState != 0) )
69       {
70         notifyIcon.ShowTrayBalloon("Qbe SAS Client: Fehler", "Verbindung zum Systemdienst verloren.", TrayNotify.NIIF_ERROR);
71       } 
72 */      
73 
74       if ( (prevInetstate != inetState) && (connState == 0) )
75       {
76         if (inetState == 0)
77         {
78           notifyIcon.ShowTrayBalloon("Qbe SAS Client", "Verbindung zum Internet wurde durch das System freigegeben.", TrayNotify.NIIF_INFO);
79         }
80         if (inetState == 1)
81         {
82           notifyIcon.ShowTrayBalloon("Qbe SAS Client", "Verbindung zum Internet wurde durch das System gesperrt.", TrayNotify.NIIF_INFO);
83         }
84       }
85 
86       prevConnstate = connState;
87       prevInetstate = inetState;
88     }
\end{verbatim}\normalsize 


\subsection{Dokumentation der Datenelemente}
\hypertarget{classQbeTray_1_1Tray_QbeTray_1_1Trayr0}{
\index{QbeTray::Tray@{Qbe\-Tray::Tray}!notifyIcon@{notifyIcon}}
\index{notifyIcon@{notifyIcon}!QbeTray::Tray@{Qbe\-Tray::Tray}}
\subsubsection[notifyIcon]{\setlength{\rightskip}{0pt plus 5cm}\hyperlink{classQbeTray_1_1TrayNotify}{Tray\-Notify} \hyperlink{classQbeTray_1_1Tray_QbeTray_1_1Trayr0}{notify\-Icon}\hspace{0.3cm}{\tt  \mbox{[}private\mbox{]}}}}
\label{classQbeTray_1_1Tray_QbeTray_1_1Trayr0}




Definiert in Zeile 11 der Datei Tray.cs.

Wird benutzt von Tray::timer\_\-Tick() und Tray::Tray().\hypertarget{classQbeTray_1_1Tray_QbeTray_1_1Trayr3}{
\index{QbeTray::Tray@{Qbe\-Tray::Tray}!prevConnstate@{prevConnstate}}
\index{prevConnstate@{prevConnstate}!QbeTray::Tray@{Qbe\-Tray::Tray}}
\subsubsection[prevConnstate]{\setlength{\rightskip}{0pt plus 5cm}int \hyperlink{classQbeTray_1_1Tray_QbeTray_1_1Trayr3}{prev\-Connstate} = 0\hspace{0.3cm}{\tt  \mbox{[}private\mbox{]}}}}
\label{classQbeTray_1_1Tray_QbeTray_1_1Trayr3}




Definiert in Zeile 15 der Datei Tray.cs.

Wird benutzt von Tray::timer\_\-Tick().\hypertarget{classQbeTray_1_1Tray_QbeTray_1_1Trayr4}{
\index{QbeTray::Tray@{Qbe\-Tray::Tray}!prevInetstate@{prevInetstate}}
\index{prevInetstate@{prevInetstate}!QbeTray::Tray@{Qbe\-Tray::Tray}}
\subsubsection[prevInetstate]{\setlength{\rightskip}{0pt plus 5cm}int \hyperlink{classQbeTray_1_1Tray_QbeTray_1_1Trayr4}{prev\-Inetstate} = 1\hspace{0.3cm}{\tt  \mbox{[}private\mbox{]}}}}
\label{classQbeTray_1_1Tray_QbeTray_1_1Trayr4}




Definiert in Zeile 16 der Datei Tray.cs.

Wird benutzt von Tray::timer\_\-Tick().\hypertarget{classQbeTray_1_1Tray_QbeTray_1_1Trayr2}{
\index{QbeTray::Tray@{Qbe\-Tray::Tray}!resources@{resources}}
\index{resources@{resources}!QbeTray::Tray@{Qbe\-Tray::Tray}}
\subsubsection[resources]{\setlength{\rightskip}{0pt plus 5cm}System.Resources.Resource\-Manager \hyperlink{classQbeTray_1_1Tray_QbeTray_1_1Trayr2}{resources}\hspace{0.3cm}{\tt  \mbox{[}private\mbox{]}}}}
\label{classQbeTray_1_1Tray_QbeTray_1_1Trayr2}




Definiert in Zeile 13 der Datei Tray.cs.

Wird benutzt von Tray::timer\_\-Tick() und Tray::Tray().\hypertarget{classQbeTray_1_1Tray_QbeTray_1_1Trayr1}{
\index{QbeTray::Tray@{Qbe\-Tray::Tray}!timer@{timer}}
\index{timer@{timer}!QbeTray::Tray@{Qbe\-Tray::Tray}}
\subsubsection[timer]{\setlength{\rightskip}{0pt plus 5cm}System.Windows.Forms.Timer \hyperlink{classQbeTray_1_1Tray_QbeTray_1_1Trayr1}{timer}\hspace{0.3cm}{\tt  \mbox{[}private\mbox{]}}}}
\label{classQbeTray_1_1Tray_QbeTray_1_1Trayr1}




Definiert in Zeile 12 der Datei Tray.cs.

Wird benutzt von Tray::Tray().