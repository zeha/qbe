\hypertarget{classQbeNDI_1_1NetConfig}{
\section{Net\-Config Klassenreferenz}
\label{classQbeNDI_1_1NetConfig}\index{QbeNDI::NetConfig@{QbeNDI::NetConfig}}
}
{\tt \#include $<$NDI.h$>$}

\subsection*{\"{O}ffentliche, statische Methoden}
\begin{CompactItemize}
\item 
bool \hyperlink{classQbeNDI_1_1NetConfig_QbeNDI_1_1NetConfige0}{Install\-Net\-Service} (IN PCSTR sz\-Inf\-Full\-Path)
\item 
bool \hyperlink{classQbeNDI_1_1NetConfig_QbeNDI_1_1NetConfige1}{Uninstall\-Net\-Component} ()
\end{CompactItemize}


\subsection{Dokumentation der Elementfunktionen}
\hypertarget{classQbeNDI_1_1NetConfig_QbeNDI_1_1NetConfige0}{
\index{QbeNDI::NetConfig@{Qbe\-NDI::Net\-Config}!InstallNetService@{InstallNetService}}
\index{InstallNetService@{InstallNetService}!QbeNDI::NetConfig@{Qbe\-NDI::Net\-Config}}
\subsubsection[InstallNetService]{\setlength{\rightskip}{0pt plus 5cm}bool Install\-Net\-Service (IN PCSTR {\em sz\-Inf\-Full\-Path})\hspace{0.3cm}{\tt  \mbox{[}static\mbox{]}}}}
\label{classQbeNDI_1_1NetConfig_QbeNDI_1_1NetConfige0}




Definiert in Zeile 282 der Datei NDI.cpp.

Benutzt DWORD, Hr\-Get\-INet\-Cfg(), Hr\-Install\-Net\-Component(), Hr\-Release\-INet\-Cfg() und work\-State.



\footnotesize\begin{verbatim}283   {
284     bool ret = false;
285     HRESULT hr=S_OK;
286     INetCfg* pnc;
287 
288         // if full path to INF has been specified, the INF
289         // needs to be copied using Setup API to ensure that any other files
290         // that the primary INF copies will be correctly found by Setup API
291         //
292         if (szInfFullPath && strlen(szInfFullPath))
293         {
294 //         if (workState == 1)  strb->Append("INF Datei wurde kopiert.");
295 //         if (workState == 2)  strb->Append("Netzwerkkonfiguration wurde gelockt.");
296 //         if (workState == 5)  strb->Append("NetService wird installiert...");
297 //         if (workState == 6)  strb->Append("Installation fertig.");
298 
299             CHAR szInfNameAfterCopy[MAX_PATH+1];
300             if (SetupCopyOEMInf(
301                     szInfFullPath,
302                     NULL,               // other files are in the
303                                         // same dir. as primary INF
304                     SPOST_PATH,         // first param. contains path to INF
305                     0,                  // default copy style
306                     szInfNameAfterCopy, // receives the name of the INF
307                                         // after it is copied to %windir%\inf
308                     MAX_PATH,           // max buf. size for the above
309                     NULL,               // receives required size if non-null
310                     NULL))              // optionally retrieves filename
311                                         // component of szInfNameAfterCopy
312             {
313                // ShowMessage(L"...%s was copied to %s",
314                //             szInfFullPath,
315                //             szInfNameAfterCopy);
316         
317             }
318             else
319             {
320                 DWORD dwError = GetLastError();
321                 hr = HRESULT_FROM_WIN32(dwError);
322             }
323       workState = 1;
324       Sleep(10);
325         }
326 
327         if (S_OK == hr)
328         {
329             // get INetCfg interface
330             hr = HrGetINetCfg(TRUE, &pnc);
331       workState = 2;
332       Sleep(10);
333 
334             if (SUCCEEDED(hr))
335             {
336         workState = 5;
337         Sleep(10);
338 
339         // install szComponentId
340                 hr = HrInstallNetComponent(pnc, L"QBE_CLIENTSERVICE", &GUID_DEVCLASS_NETSERVICE);
341                 if (SUCCEEDED(hr))
342                 {
343           workState = 6;
344           Sleep(10);
345 
346                     // Apply the changes
347                     hr = pnc->Apply();
348           ret = true;
349                 }
350 
351         // release INetCfg
352                 (void) HrReleaseINetCfg(TRUE, pnc);
353 
354 
355             }
356         }
357         // show success/failure message
358         //ShowHrMessage(hr);
359 
360     return ret;
361   }
\end{verbatim}\normalsize 
\hypertarget{classQbeNDI_1_1NetConfig_QbeNDI_1_1NetConfige1}{
\index{QbeNDI::NetConfig@{Qbe\-NDI::Net\-Config}!UninstallNetComponent@{UninstallNetComponent}}
\index{UninstallNetComponent@{UninstallNetComponent}!QbeNDI::NetConfig@{Qbe\-NDI::Net\-Config}}
\subsubsection[UninstallNetComponent]{\setlength{\rightskip}{0pt plus 5cm}bool Uninstall\-Net\-Component ()\hspace{0.3cm}{\tt  \mbox{[}static\mbox{]}}}}
\label{classQbeNDI_1_1NetConfig_QbeNDI_1_1NetConfige1}




Definiert in Zeile 363 der Datei NDI.cpp.

Benutzt Hr\-Get\-INet\-Cfg(), Hr\-Release\-INet\-Cfg() und Hr\-Uninstall\-Net\-Component().

Wird benutzt von Main\-Form::tmr\-Run\_\-Tick().



\footnotesize\begin{verbatim}364   {
365     bool ret = false;
366     HRESULT hr=S_OK;
367     INetCfg* pnc;
368 
369     //ShowMessage(L"Trying to uninstall '%s'...", szComponentId);
370 
371     // get INetCfg interface
372     hr = HrGetINetCfg(TRUE, &pnc);
373 
374     if (SUCCEEDED(hr))
375     {
376       // uninstall szComponentId
377       hr = HrUninstallNetComponent(pnc, L"QBE_CLIENTSERVICE");
378 
379       if (S_OK == hr)
380       {
381         // Apply the changes
382         hr = pnc->Apply();
383         ret = true;
384       }
385       else if (S_FALSE == hr)
386       {
387       //  ShowMessage(L"...'%s' is not installed", szComponentId);
388       }
389 
390       // release INetCfg
391       (void) HrReleaseINetCfg(TRUE, pnc);
392     }
393 
394     // show success/failure message
395     //ShowHrMessage(hr);
396 
397     return ret;
398   }
\end{verbatim}\normalsize 
